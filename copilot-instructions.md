# Copilot Instructions（Forgetting-curve）

このリポジトリでは、GitHub Copilot（Chat/Agent）に対して、以下の指示に従って作業してください。

## 1. 目的
- 忘却曲線に基づく暗記支援アプリを開発する
- 要件→設計→実装→テストを一貫して整合させる

## 2. 参照すべき設計書（最優先）
- 要件定義: design/Requirements/app.md

実装やテストの作成時は、上記ファイルの内容と矛盾しないこと。
矛盾・未決事項がある場合は、勝手に断定して進めず「質問（確認事項）」として列挙すること。

## 3. スコープ（MVP）
MVPは原則として以下を優先して実装する（順不同ではなく、基盤→コア→UI）。
- 学習項目（learning items）のCRUD
- 復習（review）完了操作と次回復習日の更新
- 本日復習が必要な項目の一覧（優先表示）

後回し（要件にあるがMVP外にできる）
- 統計/グラフの作り込み
- 通知
- 認証/認可（将来実装として設計・拡張性は考慮してよいが、勝手に必須化しない）

## 4. 技術スタック（前提）
- フロント: React
- バックエンド: Node.js
- DB: PostgreSQL
- CSS: Tailwind CSS
- ORM: Prisma
- TypeScript

## 5. 実装方針
- 小さく作る：1回の変更は1機能（1エンドポイント/1画面/1ロジック）に限定
- 変更理由が説明できる最小差分にする（不要なリファクタは避ける）
- 例外/バリデーション/境界条件（期限超過・当日・最終サイクル）を必ず考慮
- 日付・時刻はタイムゾーンを意識し、DBの型（DATE/TIMESTAMP）との整合を取る

## 6. 復習サイクル（忘却曲線）に関するルール
要件に記載の復習サイクルを採用する。
- 1日以内
- 3日後
- 1週間後
- 2週間後
- 1か月後

実装時は以下を明確化すること（未決なら質問にする）。
- 「1日以内」の意味（例：次回復習日=翌日/当日中など）
- 月の扱い（30日固定か暦月か）
- 期限超過の扱い（期限を過ぎた場合の優先度・表示・次回計算）

## 7. データとAPIの一貫性
- DBスキーマ、API仕様、UI表示で用語とフィールド名を統一
- 学習項目、復習履歴の関係（1:N）を崩さない
- 追加/変更するフィールドは設計書へフィードバックする（必要なら設計書更新を同PRに含める）

## 8. テスト方針
- 新規機能にはテストを必ず追加（最低でも正常系＋代表的な異常系）
- 重点テスト観点
  - 復習完了時の次回日付計算
  - 期限超過・当日・期限直前の並び順
  - 存在しないID、バリデーションエラーのHTTPステータス
  - 検索/フィルタ条件

## 9. ドキュメント/Markdown
- 変更により仕様が動く場合は、関連設計書も更新する
- Markdownの整形（空行、コードフェンスの言語指定など）を守る

## 10. 進め方（Copilotへの依頼テンプレ）
- 「design/Requirements/app.md を参照し、◯◯を実装して。受け入れ条件は…」
- 「◯◯APIの詳細設計（入力/出力/バリデーション/エラー/テスト観点）を書いて」
- 「上記設計に従って実装し、対応するテストも追加して」

## 11. 不明点が出た場合
以下を必ず提示してから進めること。
- 質問（確認事項）
- 仮定する場合は「仮定」と明記し、影響範囲も書く

## 12. コードスタイル
- コードスタイルはプロジェクトで採用しているESLint/Prettierルールに従うこと。

## 13. 実装方針
- アプリケーションは、PC、タブレット、スマートフォンでの利用を想定し、レスポンシブデザインを採用すること。
  - 各画面サイズの分岐点は、以下とする。
    - スマートフォン: 幅 0px ～ 599px
    - タブレット: 幅 600px ～ 899px
    - PC: 幅 900px 以上
- UIコンポーネントライブラリとしては、Material-UIまたはChakra UIを使用し、一貫したデザインとユーザーエクスペリエンスを提供すること。
- バリデーションは、フロントエンドとバックエンドの両方で実装し、ユーザー入力の整合性を確保すること。
- セキュリティを考慮して、バックエンドでは入力データのバリデーションを徹底し、SQLインジェクションやXSS攻撃などの一般的な脆弱性に対策を講じること。